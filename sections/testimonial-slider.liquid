{{ 'testimonial.css' | asset_url | stylesheet_tag }}
<script src="{{ 'testimonial.js' | asset_url }}" defer="defer"></script>

<section class="testimonial-slider" data-testimonial-slider data-section-id="{{ section.id }}">
  <div class="page-width">
    {% if section.settings.heading != blank %}
      <div class="testimonial-slider__header">
        <h2>{{ section.settings.heading }}</h2>
      </div>
    {% endif %}

    <div class="testimonial-slider__viewport" data-slider-viewport>
      <div class="testimonial-slider__track" data-slider-track>
        {% for block in section.blocks %}
          <article class="testimonial-slide" {{ block.shopify_attributes }}>
            <div class="testimonial-slide__image-wrap">
              {% if block.settings.image != blank %}
                {{ block.settings.image | image_url: width: 300 | image_tag: alt: block.settings.name, loading: 'lazy', class: 'testimonial-slide__image' }}
              {% else %}
                {{ 'image' | placeholder_svg_tag: 'testimonial-slide__image testimonial-slide__image--placeholder' }}
              {% endif %}
            </div>

            <div class="testimonial-slide__content">
              <h3 class="testimonial-slide__name">{{ block.settings.name }}</h3>

              <div class="testimonial-slide__rating" aria-label="{{ block.settings.rating }} out of 5 stars">
                {% for i in (1..5) %}
                  {% if i <= block.settings.rating %}
                    <span aria-hidden="true">★</span>
                  {% else %}
                    <span aria-hidden="true" class="testimonial-slide__star--muted">★</span>
                  {% endif %}
                {% endfor %}
              </div>

              <p class="testimonial-slide__text">{{ block.settings.review }}</p>
            </div>
          </article>
        {% endfor %}
      </div>
    </div>

    <div class="testimonial-slider__controls">
      <button type="button" class="testimonial-slider__button" data-slider-prev aria-label="Previous testimonial">‹</button>
      <button type="button" class="testimonial-slider__button" data-slider-next aria-label="Next testimonial">›</button>
    </div>

    {% if section.settings.explore_button_link != blank %}
      <div class="testimonial-slider__explore">
        <a href="{{ section.settings.explore_button_link }}" class="btn btn--accent">
          {{ section.settings.explore_button_label | default: 'Explore' }}
        </a>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Testimonial slider",
  "tag": "section",
  "class": "section-testimonial-slider",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "What our customers say"
    },
    {
      "type": "text",
      "id": "explore_button_label",
      "label": "Explore button label",
      "default": "Explore"
    },
    {
      "type": "url",
      "id": "explore_button_link",
      "label": "Explore button link"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Customer image"
        },
        {
          "type": "text",
          "id": "name",
          "label": "Name",
          "default": "Customer name"
        },
        {
          "type": "textarea",
          "id": "review",
          "label": "Review text",
          "default": "Absolutely delicious food and fast delivery. Highly recommended!"
        },
        {
          "type": "range",
          "id": "rating",
          "label": "Star rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5
        }
      ]
    }
  ],
  "max_blocks": 5,
  "presets": [
    {
      "name": "Testimonial slider",
      "blocks": [
        {
          "type": "testimonial",
          "settings": {
            "name": "Aarav Patel",
            "review": "The paneer tikka wraps are amazing. Fresh, flavorful, and perfectly packed!",
            "rating": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "name": "Mei Lin",
            "review": "Great variety across cuisines and the service is super quick every time.",
            "rating": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "name": "Luca Moretti",
            "review": "Loved the pasta options. Rich taste and quality ingredients.",
            "rating": 4
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "name": "Sophia Reed",
            "review": "Desserts are top-notch. The brownies were soft and indulgent.",
            "rating": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "name": "Noah Carter",
            "review": "Reliable, tasty, and easy to order from. This is now my go-to food store.",
            "rating": 4
          }
        }
      ]
    }
  ]
}
{% endschema %}
